jQuery(document).on("dragstart",".uip-user-drag",function(e){let i=[],t="1 "+uipTranslations.user;if(jQuery(".uip-user-check:checkbox:checked").length>0)jQuery(".uip-user-check:checkbox:checked").each(function(e){let t=jQuery(this).attr("data-id");i.push(t)}),e.originalEvent.dataTransfer.setData("itemID",JSON.stringify(i)),t=i.length+" "+uipTranslations.users;else{let i=jQuery(e.currentTarget).attr("data-id");e.originalEvent.dataTransfer.setData("itemID",JSON.stringify([i]))}e.originalEvent.dataTransfer.dropEffect="move",e.originalEvent.dataTransfer.effectAllowed="move",e.originalEvent.dataTransfer.setData("type","content");let a=document.createElement("div");a.id="uip-content-drag",a.innerHTML=t,a.style.position="absolute",a.style.top="-1000px",document.body.appendChild(a),e.originalEvent.dataTransfer.setDragImage(a,0,0),jQuery(".uip-remove-folder").addClass("uip-nothidden")});export function moduleData(){return{emits:["group-change"],props:{appdata:Object,updateactivegroup:Function,currentGroup:[Number,String],updateuserdata:Function},data(){return{loading:!0,screenWidth:window.innerWidth,mediaCount:0,noFolderCount:0,folders:[],activeGroup:this.currentGroup,activeFolderObject:[],openFolders:[],ui:{createNew:{open:!1,name:"",color:"#0c5cef",icon:"group_work"},edit:{open:!1,active:this.activeFolderObject}}}},watch:{},created:function(){window.addEventListener("resize",this.getScreenWidth)},computed:{formattedFolders(){return this.folders}},mounted:function(){this.getGroups()},methods:{openCreateFolder(){this.ui.createNew.open=!0},openEditFolder(){this.ui.edit.open=!0},deleteFolder(){let e=this,i={action:"uip_delete_user_group",security:uip_user_app_ajax.security,activeFolder:e.activeGroup};jQuery.ajax({url:uip_user_app_ajax.ajax_url,type:"post",data:i,success:function(t){i=JSON.parse(t),e.loading=!1,i.error?uipNotification(i.error):(e.setActiveGroup("all",{}),uipNotification(i.message),e.getGroups())}})},createFolder(){let e=this,i={action:"uip_create_user_group",security:uip_user_app_ajax.security,folderInfo:e.ui.createNew,parent:e.activeGroup};jQuery.ajax({url:uip_user_app_ajax.ajax_url,type:"post",data:i,success:function(t){i=JSON.parse(t),e.loading=!1,i.error?uipNotification(i.error):(uipNotification(i.message),e.getGroups())}})},addDropClass(e,i){e.preventDefault();let t=e.target;this.dragCounter++,jQuery(t).hasClass("uip-folder-can-drop")?jQuery(t).addClass("uip-background-primary-wash"):jQuery(t).closest(".uip-folder-can-drop").addClass("uip-background-primary-wash")},removeDropClass(e,i){e.preventDefault();let t=e.target;this.dragCounter--,0==this.dragCounter&&(jQuery(t).hasClass("uip-folder-can-drop")?jQuery(t).removeClass("uip-background-primary-wash"):jQuery(t).closest(".uip-folder-can-drop").removeClass("uip-background-primary-wash"))},removeFromFolder(e){this.dragCounter=0;let i=e.dataTransfer.getData("itemID"),t=e.dataTransfer.getData("type");i="folder"==t?[i]:JSON.parse(i),this.removeTheFolder(i,t),jQuery(".uip-folder-can-drop").removeClass("uip-background-primary-wash"),jQuery(".uip-remove-folder").removeClass("uip-nothidden")},removeTheFolder(e,i){let t=this;data={action:"uip_remove_from_folder",security:uip_user_app_ajax.security,items:e,itemtype:i},jQuery.ajax({url:uip_user_app_ajax.ajax_url,type:"post",data:data,success:function(e){data=JSON.parse(e),t.loading=!1,data.error?uipNotification(data.error):(uipNotification(data.message),t.refreshFolders())}})},updateFolder(){let e=this,i={action:"uip_update_user_group",security:uip_user_app_ajax.security,folderInfo:e.ui.edit.active};jQuery.ajax({url:uip_user_app_ajax.ajax_url,type:"post",data:i,success:function(t){i=JSON.parse(t),e.loading=!1,i.error?uipNotification(i.error):(uipNotification(i.message),e.getGroups())}})},removeFromFolder(e){this.dragCounter=0;let i=e.dataTransfer.getData("itemID"),t=e.dataTransfer.getData("type");i="folder"==t?[i]:JSON.parse(i),this.removeTheFolder(i,t),jQuery(".uip-folder-can-drop").removeClass("uip-background-primary-wash"),jQuery(".uip-remove-folder").removeClass("uip-nothidden")},removeTheFolder(e,i){let t=this,a={action:"uip_remove_from_group",security:uip_user_app_ajax.security,items:e,itemtype:i};jQuery.ajax({url:uip_user_app_ajax.ajax_url,type:"post",data:a,success:function(e){a=JSON.parse(e),t.loading=!1,a.error?uipNotification(a.error):(uipNotification(a.message),t.getGroups())}})},getScreenWidth(){this.screenWidth=window.innerWidth},isSmallScreen(){return this.screenWidth<1e3},setActiveGroup(e,i){this.activeGroup=e,this.updateactivegroup(e),i&&(this.ui.edit.active=i)},setOpenFolders(e){this.openFolders.includes(e)?(index=this.openFolders.indexOf(e),this.openFolders.splice(index,1)):this.openFolders.push(e),this.openFolders||(this.openFolders=[])},getGroups(){let e=this,i={action:"uip_get_user_groups",security:uip_user_app_ajax.security};jQuery.ajax({url:uip_user_app_ajax.ajax_url,type:"post",data:i,success:function(t){i=JSON.parse(t),e.loading=!1,i.error||(e.folders=i.folders,e.mediaCount=i.mediaCount,e.noFolderCount=i.noFolderCount)}})},getNewIcon(e){this.ui.createNew.icon=e},getActiveIcon(e){this.ui.edit.active.icon=e}},template:'<div class="uip-padding-top-xs">         \x3c!-- DEFAULT GROUPS --\x3e         <div class="uip-margin-bottom-s">           <div @click="setActiveGroup(\'all\')" :class="{\'uip-background-muted uip-text-bold uip-text-emphasis\' : activeGroup == \'all\'}"           class="uip-border-round uip-flex uip-padding-xxs uip-text-m hover:uip-background-muted uip-cursor-pointer uip-margin-bottom-xxs">             <span class="material-icons-outlined uip-margin-right-xxs">group</span>             <span class="uip-flex-grow">{{appdata.translations.allUsers}}</span>             <span class="uip-border-round uip-background-primary-wash uip-padding-left-xxs uip-padding-right-xxs">{{mediaCount}}</span>           </div>           <div @click="setActiveGroup(\'nofolder\')"  :class="{\'uip-background-muted uip-text-bold uip-text-emphasis\' : activeGroup == \'nofolder\'}"           class="uip-border-round uip-flex uip-padding-xxs uip-text-m hover:uip-background-muted uip-cursor-pointer ">             <span class="material-icons-outlined uip-margin-right-xxs">group_off</span>             <span class="uip-flex-grow">{{appdata.translations.noGroup}}</span>             <span class="uip-border-round uip-background-primary-wash uip-padding-left-xxs uip-padding-right-xxs">{{noFolderCount}}</span>           </div>         </div>         \x3c!-- USER GROUPS --\x3e         <div class="uip-margin-bottom-xs uip-padding-xxs uip-flex">             <div class="uip-text-muted">{{appdata.translations.groups}}</div>             <div class="uip-flex-grow uip-margin-left-xs uip-flex">               <div @click="openCreateFolder()"               class="uip-background-muted uip-border-round material-icons-outlined hover:uip-background-grey uip-cursor-pointer">add</div>             </div>             <div @click="openEditFolder()" v-if="!isNaN(activeGroup)"             class="uip-background-muted uip-border-round material-icons-outlined uip-margin-left-xs hover:uip-background-grey uip-cursor-pointer">edit</div>             <div @click="deleteFolder()" v-if="!isNaN(activeGroup)"             class="uip-background-red-wash uip-border-round material-icons-outlined uip-margin-left-xs hover:uip-background-grey uip-cursor-pointer">delete_outline</div>         </div>         <p class="uip-padding-xxs uip-text-muted" v-if="formattedFolders.length < 1">{{appdata.translations.noGroupCreated}}</p>         <div class="uip-overflow-auto uip-max-h-400">             <template v-for="folder in formattedFolders">               <group-template :updateuserdata="updateuserdata" :appdata="appdata" :refreshFolders="getGroups" :openFolders="openFolders" :setOpenFolders="setOpenFolders" :folder="folder"                :activeFolder="activeGroup" :folderUpdate="setActiveGroup"></group-template>             </template>         </div>         \x3c!-- REMOVE FROM FOLDER --\x3e         <div @drop="removeFromFolder($event, folder)"          @dragenter="addDropClass($event, folder)"         @dragleave="removeDropClass($event, folder)"         @dragover.prevent         @dragenter.prevent         class="uip-background-muted uip-border-round uip-flex uip-padding-xs uip-margin-top-s uip-text-m uip-folder-can-drop uip-remove-folder uip-hidden">           {{appdata.translations.removeFromGroup}}         </div>         \x3c!--NEW GROUP OFFCANVAS --\x3e         <offcanvas :open="ui.createNew.open" :closeOffcanvas="function() {ui.createNew.open = false}">            <div class="uip-flex uip-margin-bottom-m">              <div class="uip-text-xl uip-text-bold uip-flex-grow">{{appdata.translations.newGroup}}</div>            </div>            <div class="uip-margin-bottom-s">              <div class="uip-text-muted uip-margin-bottom-xs">{{appdata.translations.name}}:</div>              <input class="uip-w-100p uip-standard-input" type="text" :placeholder="appdata.translations.groupName" style="padding: 5px 8px;"              v-model="ui.createNew.name">            </div>            <div class="uip-margin-bottom-s">              <div class="uip-text-muted uip-margin-bottom-xs">{{appdata.translations.color}}:</div>              <div class="uip-margin-bottom-xm uip-padding-xxs uip-border uip-border-round uip-w-200" style="padding: 5px 8px;">                <div class="uip-flex uip-flex-center">                  <span class="uip-margin-right-xs uip-text-muted uip-margin-right-s">                      <label class="uip-border-circle uip-h-18 uip-w-18 uip-border uip-display-block" v-bind:style="{\'background-color\' : ui.createNew.color}">                        <input                        type="color"                        v-model="ui.createNew.color" style="visibility: hidden;">                      </label>                  </span>                   <input v-model="ui.createNew.color" type="search" placeholder="#HEX" class="uip-blank-input uip-margin-right-s " style="min-width:0;">                  <span class="uip-text-muted">                      <span class="material-icons-outlined uip-text-muted">color_lens</span>                  </span>                </div>              </div>            </div>            <div class="uip-margin-bottom-m">              <div class="uip-text-muted uip-margin-bottom-xs">{{appdata.translations.groupIcon}}:</div>              <icon-select :currentIcon="ui.createNew.icon" :updateIcon="getNewIcon"></icon-select>            </div>            <div class="">              <button @click="createFolder()" class="uip-button-primary uip-padding-xs" type="button">{{appdata.translations.createGroup}}</button>            </div>         </offcanvas>         \x3c!--END NEW GROUP OFFCANVAS --\x3e         \x3c!--EDIT GROUP OFFCANVAS --\x3e          <offcanvas :open="ui.edit.open" :closeOffcanvas="function() {ui.edit.open = false}">              <div class="uip-flex uip-margin-bottom-m">                <div class="uip-text-xl uip-text-bold uip-flex-grow">{{appdata.translations.editGroup}}</div>              </div>              <div class="uip-margin-bottom-s">                <div class="uip-text-muted uip-margin-bottom-xs">{{appdata.translations.name}}:</div>                <input class="uip-w-100p uip-standard-input" type="text" :placeholder="appdata.translations.groupName" style="padding: 5px 8px;"                v-model="ui.edit.active.title">              </div>              <div class="uip-margin-bottom-s">                <div class="uip-text-muted uip-margin-bottom-xs">{{appdata.translations.color}}:</div>                <div class="uip-margin-bottom-xm uip-padding-xxs uip-border uip-border-round uip-w-200" style="padding: 5px 8px;">                  <div class="uip-flex uip-flex-center">                    <span class="uip-margin-right-xs uip-text-muted uip-margin-right-s">                        <label class="uip-border-circle uip-h-18 uip-w-18 uip-border uip-display-block" v-bind:style="{\'background-color\' : ui.edit.active.color}">                          <input                          type="color"                          v-model="ui.edit.active.color" style="visibility: hidden;">                        </label>                    </span>                     <input v-model="ui.edit.active.color" type="search" placeholder="#HEX" class="uip-blank-input uip-margin-right-s " style="min-width:0;">                    <span class="uip-text-muted">                        <span class="material-icons-outlined uip-text-muted">color_lens</span>                    </span>                  </div>                </div>              </div>              <div class="uip-margin-bottom-m">                <div class="uip-text-muted uip-margin-bottom-xs">{{appdata.translations.groupIcon}}:</div>                <icon-select :currentIcon="ui.edit.active.icon" :updateIcon="getActiveIcon"></icon-select>              </div>              <div class="">                <button @click="updateFolder()" class="uip-button-primary uip-padding-xs" type="button">{{appdata.translations.updateGroup}}</button>              </div>          </offcanvas>           \x3c!--END NEW GROUP OFFCANVAS --\x3e      </div>'}};