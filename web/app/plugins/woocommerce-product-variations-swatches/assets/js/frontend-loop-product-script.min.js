function viwpvs_frontend_loop_init(){jQuery(".vi_wpvs_loop_variation_form:not(.vi_wpvs_loop_variation_form_check)").each(function(){let a=viwpvs_set_swatches_position(jQuery(this));a.removeClass("vi-wpvs-hidden").addClass("vi_wpvs_loop_variation_form_check").wpvs_get_variation(),a.addClass("vi_wpvs_variation_form vi_wpvs_variation_form_init").viwpvs_woo_product_variation_swatches()})}function viwpvs_set_swatches_position(a){if(a=jQuery(a),-1!==jQuery.inArray(viwpvs_frontend_loop_product_params.theme,["woostify"])){let d,b;if(a.closest(".product").length&&((d=a.closest(".product")).addClass("vi_wpvs_loop_variation_woostify"),b=d.find(".product-loop-meta .animated-meta"),viwpvs_frontend_loop_product_params.theme_swatches_pos)){let c=a.clone();a.remove(),b.append('<span class="vi_wpvs_loop_variation_price vi_wpvs_loop_variation_hidden"></span>'),b.find(".vi_wpvs_loop_variation_price").remove(),"after_price"===viwpvs_frontend_loop_product_params.theme_swatches_pos?(c.insertAfter(b.find(".price")),jQuery('<span class="vi_wpvs_loop_variation_price vi_wpvs_loop_variation_hidden"></span>').insertBefore(b.find(".vi_wpvs_loop_variation_form"))):(c.insertBefore(b.find(".price")),jQuery('<span class="vi_wpvs_loop_variation_price vi_wpvs_loop_variation_hidden"></span>').insertAfter(b.find(".vi_wpvs_loop_variation_form"))),a=c}}return a}function viwpvs_fixed(){jQuery(document).on("append.infiniteScroll",function(b,c,d,a){jQuery(a).find(".vi_wpvs_loop_variation_form:not(.vi_wpvs_loop_variation_form_check)").each(function(b,a){jQuery(a).removeClass("vi-wpvs-hidden").addClass("vi_wpvs_loop_variation_form_check vi_wpvs_variation_form vi_wpvs_variation_form_init").wpvs_get_variation().viwpvs_woo_product_variation_swatches()})}),"undefined"!=typeof $us&&($us.WGrid.prototype.afterAppendItems=function(a){jQuery(a).find(".vi_wpvs_loop_variation_form:not(.vi_wpvs_loop_variation_form_check)").each(function(b,a){jQuery(a).removeClass("vi-wpvs-hidden").addClass("vi_wpvs_loop_variation_form_check vi_wpvs_variation_form vi_wpvs_variation_form_init").wpvs_get_variation().viwpvs_woo_product_variation_swatches()})})}jQuery(document).ready(function($){"use strict";function a(){jQuery(".vi_wpvs_loop_variation_form:not(.vi_wpvs_loop_variation_form_check)").each(function(b,a){jQuery(a).removeClass("vi-wpvs-hidden").addClass("vi_wpvs_loop_variation_form_check vi_wpvs_variation_form vi_wpvs_variation_form_init").wpvs_get_variation().viwpvs_woo_product_variation_swatches()})}jQuery(document).on("viwpvs_init_swatches",function(){jQuery(window).trigger("resize")}),viwpvs_frontend_loop_init(),jQuery(document).on("jet-filter-content-rendered",function(){a()}),jQuery(document).on("facetwp-loaded",function(){a()}),window.hasOwnProperty("Riode")&& void 0!==window.Riode&&window.Riode.$window.on("update_lazyload",function(){a()}),jQuery(document).on("facetwp-loaded",function(){a()}),jQuery(document).on("avalon23-end-redraw-page",function(){a()}),window.almComplete=function(b){a()},jQuery(document).on("ajaxComplete",function(a,b,c){return viwpvs_frontend_loop_init(),!1}),viwpvs_fixed()}),jQuery(window).on("load",function(){"use strict";viwpvs_frontend_loop_init()});var viwpvs_get_variations=function(b){let a=this;a.is_atc=viwpvs_frontend_loop_product_params.is_atc,a.wc_ajax_url=viwpvs_frontend_loop_product_params.wc_ajax_url,a.swatches=b,a.product_id=parseInt(b.data("product_id")),a.variation=b.data("product_variations"),a.is_find_variation=b.data("vpvs_find_variation"),a.is_ajax=!a.variation,a.xhr=!1,a.img_product=jQuery(a.get_img_product(b)),a.img_src=a.img_product.attr("data-src")||a.img_product.attr("src")||a.img_product.attr("content")||a.img_product.attr("srcset")||"";let c=b.closest(".product"),d={};c.length||(c=b.closest(".item-product")),c.length||(c=b.closest(".product-item")),c.length||(c=b.closest(".gdlr-core-item-list")),c.length||(c=b.closest(".jet-woo-products__item")),c.length||(c=b.closest(".product-warp-item")),c.length||(c=b.closest(".product__box")),c.length||(c=b.closest(".woo-entry-inner")),a.product=c,c.on("click",".viwcuf_product_change_qty",function(e){e.preventDefault(),e.stopPropagation();let b=jQuery(this).closest(".vi_wpvs_loop_action_qty").find(".viwcuf_product_qty"),a=parseFloat(b.val()),c=parseFloat(b.attr("min")),d=parseFloat(b.attr("max")),f=parseFloat(b.attr("step")||1);jQuery(this).hasClass("viwcuf_product_plus")?a+=f:a-=f,c>0&&c>a&&(a=c),d>0&&a>d&&(a=d),b.val(a).trigger("change")}),c.on("click",".vi_wpvs_loop_atc_button",function(e){if(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),jQuery(this).hasClass("vi_wpvs_loop_variation_no_pointer"))return!1;c.find(".viwcuf_product_qty_tooltip").addClass("vi_wpvs_loop_variation_hidden");let i=jQuery(this),g=b.serialize();if(c.find(".viwcuf_product_qty").length>0){let d=parseInt(c.find(".viwcuf_product_qty").val()||0),h=parseInt(c.find(".viwcuf_product_qty").attr("min")||1),f=parseInt(c.find(".viwcuf_product_qty").attr("max")||0);if(0===d)return!1;if(d<h)return c.find(".viwcuf_product_qty_tooltip").removeClass("vi_wpvs_loop_variation_hidden").html(viwpvs_frontend_loop_product_params.less_min_qty+" "+h+"."),setTimeout(function(){c.find(".viwcuf_product_qty_tooltip").addClass("vi_wpvs_loop_variation_hidden")},2e3),!1;if(f>0&&d>f)return c.find(".viwcuf_product_qty_tooltip").removeClass("vi_wpvs_loop_variation_hidden").html(viwpvs_frontend_loop_product_params.greater_max_qty+" "+f+"."),setTimeout(function(){c.find(".viwcuf_product_qty_tooltip").addClass("vi_wpvs_loop_variation_hidden")},2e3),!1;g+="&quantity="+d}jQuery.ajax({type:"post",url:a.wc_ajax_url.toString().replace("%%endpoint%%","wpvs_add_to_cart"),data:g,beforeSend:function(a){i.removeClass("added").addClass("loading")},complete:function(a){i.removeClass("loading").addClass("added")},success:function(a){return a.error?(window.location=c.find("a:not(.added_to_cart)").first().attr("href"),!1):"yes"===viwpvs_frontend_loop_product_params.cart_redirect_after_add?(window.location=viwpvs_frontend_loop_product_params.cart_url,!1):void(jQuery(document.body).trigger("added_to_cart",[a.fragments,a.cart_hash,i]),viwpvs_frontend_loop_product_params.woocommerce_enable_ajax_add_to_cart||jQuery(document.body).trigger("wc_fragment_refresh"),jQuery(document.body).trigger("update_checkout"),jQuery(document.body).trigger("viwpvs_added_to_cart",[a,i]),jQuery("#nm-menu-cart-btn").click())}})}),b.on("viwpvs_check_variations",{viwpvs_get_variations:a},a.find_variation),b.on("change","select",{viwpvs_get_variations:a},a.onChange),b.find(".vi-wpvs-variation-wrap-wrap-hasdefault").each(function(b,a){(a=jQuery(a)).find("select").val()||a.find("select").val(a.data("selected"))}),b.find("select").each(function(){let a=jQuery(this).val();d[jQuery(this).data("attribute_name")]=a}),a.current_attr=d,a.is_find_variation&&setTimeout(function(){b.trigger("viwpvs_check_variations")},100)};viwpvs_get_variations.prototype.onChange=function(c){let b=c.data.viwpvs_get_variations,a=b.swatches;b.img_product=b.get_img_product(a,!0),a.find('input[name="variation_id"], input.variation_id').val("").trigger("change"),b.current_attr[jQuery(this).data("attribute_name")]=jQuery(this).val()||"",b.is_ajax?(a.trigger("viwpvs_check_variations"),b.is_find_variation||a.trigger("viwpvs_variation_select_change")):(a.trigger("woocommerce_variation_select_change"),a.trigger("viwpvs_check_variations")),a.trigger("woocommerce_variation_has_changed")},viwpvs_get_variations.prototype.find_variation=function(i){let a=i.data.viwpvs_get_variations,f=null,h=!1,g=a.current_attr,c=a.product,b=a.variation,d=a.img_product,e=a.img_src;if(a.is_find_variation?jQuery.each(g,function(b,a){if(!a)return h=!0,!1}):h=!0,h)return a.update_attributes(g,b,c,a),a.show_variation(a,f,c,d,e),!1;a.is_ajax?(a.xhr&&a.xhr.abort(),b?(jQuery.each(b,function(c,b){if(a.check_is_equal(g,b.attributes))return f=b,!1}),f?a.show_variation(a,f,c,d,e):b.length<parseInt(a.swatches.data("variation_count")||0)?a.call_ajax(g,b,c,a.swatches,a,d,e):a.show_variation(a,f,c,d,e)):(b=[],a.call_ajax(g,b,c,a.swatches,a,d,e))):(jQuery.each(b,function(c,b){if(a.check_is_equal(g,b.attributes))return f=b,!1}),a.update_attributes(g,b,c,a),a.show_variation(a,f,c,d,e))},viwpvs_get_variations.prototype.update_attributes=function(c,d,b,a){if(a.is_ajax||!a.is_find_variation)return!1;b.find("select").each(function(A,x){let b=jQuery(x),t=b.data("attribute_name")||b.attr("name"),y=b.data("show_option_none"),g=b.val()||"",j=!0,e=jQuery("<select/>"),k,h=":gt(0)";if(!b.data("attribute_html")){let l=b.clone();l.find("option").removeAttr("disabled attached selected"),b.data("attribute_options",l.find("option"+h).get()),b.data("attribute_html",l.html())}e.html(b.data("attribute_html"));let u=jQuery.extend(!0,{},c);u[t]="";let f=[];for(let m=0;m<d.length;m++){let v=d[m];a.check_is_equal(u,v.attributes)&&f.push(v)}for(let n in f){if(void 0===f[n])continue;let o=f[n].attributes;for(let p in o){if(!o.hasOwnProperty(p))continue;let i=o[p],q="";if(p===t){if(f[n].variation_is_active&&(q="enabled"),i){i=jQuery("<div/>").html(i).text();let r=e.find("option");if(r.length)for(let s=0,z=r.length;s<z;s++){let w=jQuery(r[s]);if(i===w.val()){w.addClass("attached "+q);break}}}else e.find("option:gt(0)").addClass("attached "+q)}}}k=e.find("option.attached").length,g&&(j=!1,0!==k&&e.find("option.attached.enabled").each(function(){var a=jQuery(this).val();if(g===a)return j=!0,!1})),k>0&&g&&j&&"no"===y&&(e.find("option:first").remove(),h=""),e.find("option"+h+":not(.attached)").remove(),b.html(e.html()),b.find("option"+h+":not(.enabled)").prop("disabled",!0),g?j?b.val(g):b.val("").change():b.val("")}),a.swatches.trigger("woocommerce_update_variation_values")},viwpvs_get_variations.prototype.call_ajax=function(b,c,d,e,a,f,g){b.product_id=a.product_id,a.xhr=jQuery.ajax({url:a.wc_ajax_url.toString().replace("%%endpoint%%","get_variation"),type:"POST",data:b,beforeSend:function(){e.find(".vi_wpvs_loop_variation_form_loading").removeClass("vi_wpvs_loop_variation_form_loading_hidden").addClass("vi_wpvs_loop_variation_form_loading_visible")},success:function(e){a.show_variation(a,e,d,f,g),e&&(c[c.length||0]=e),delete b.product_id},complete:function(){e.find(".vi_wpvs_loop_variation_form_loading").removeClass("vi_wpvs_loop_variation_form_loading_visible").addClass("vi_wpvs_loop_variation_form_loading_hidden")}})},viwpvs_get_variations.prototype.show_variation=function(b,c,a,e,f){if(c){let d=!1;e&&jQuery(e).length&&a.find(".vi_wpvs_loop_atc_button").length>0&&setTimeout(function(){jQuery(e).parent().is("picture")&&jQuery(e).parent().find("source").each(function(b,a){jQuery(a).attr({src:c.image.thumb_src,srcset:c.image.thumb_src})}),e.attr({src:c.image.thumb_src,srcset:c.image.thumb_src}),e.is(".show-on-hover")&&jQuery(e).parent().find("img").not(e).each(function(b,a){jQuery(a).attr({src:c.image.thumb_src,srcset:c.image.thumb_src})});let a=e.closest(".has-hover-image");a.length>0&&a.find(".hover-gallery-image").attr({src:c.image.thumb_src,srcset:c.image.thumb_src})},10),c.price_html&&(a.find(".price:not(.vi_wpvs_loop_variation_price),.gdlr-core-product-price:not(.vi_wpvs_loop_variation_price)").addClass("vi_wpvs_loop_variation_hidden"),a.find(".vi_wpvs_loop_variation_price").removeClass("vi_wpvs_loop_variation_hidden").html(c.price_html)),b.is_atc&&(d=!0,c.is_purchasable&&c.is_in_stock&&c.variation_is_visible||(d=!1),d?(b.set_add_to_cart(c.variation_id,b.swatches),a.find(".add-to-cart-grid, .add_to_cart_button:not(.vi_wpvs_loop_atc_button)").addClass("vi_wpvs_loop_variation_hidden"),a.find(".vi_wpvs_loop_atc_button").removeClass("vi_wpvs_loop_variation_hidden vi_wpvs_loop_variation_no_pointer"),a.find(".vi_wpvs_loop_action").removeClass("vi_wpvs_loop_variation_hidden"),a.find(".vi_wpvs_loop_action .viwcuf_product_qty").attr({min:c.min_qty,max:c.max_qty})):(b.set_add_to_cart("",b.swatches),a.find(".add-to-cart-grid, .add_to_cart_button:not(.vi_wpvs_loop_atc_button)").addClass("vi_wpvs_loop_variation_hidden"),a.find(".vi_wpvs_loop_atc_button").removeClass("vi_wpvs_loop_variation_hidden").addClass("vi_wpvs_loop_variation_no_pointer"),a.find(".vi_wpvs_loop_action").removeClass("vi_wpvs_loop_variation_hidden"))),b.swatches.trigger("viwpvs_show_variation",[c,d])}else a.find(".price:not(.vi_wpvs_loop_variation_price),.gdlr-core-product-price:not(.vi_wpvs_loop_variation_price)").removeClass("vi_wpvs_loop_variation_hidden"),a.find(".vi_wpvs_loop_variation_price").addClass("vi_wpvs_loop_variation_hidden"),b.is_atc&&(b.set_add_to_cart("",b.swatches),a.find(".add-to-cart-grid, .add_to_cart_button:not(.vi_wpvs_loop_atc_button)").addClass("vi_wpvs_loop_variation_hidden"),a.find(".vi_wpvs_loop_atc_button").removeClass("vi_wpvs_loop_variation_hidden").addClass("vi_wpvs_loop_variation_no_pointer"),a.find(".vi_wpvs_loop_action").removeClass("vi_wpvs_loop_variation_hidden")),jQuery(b.swatches).trigger("viwpvs_hide_variation")},viwpvs_get_variations.prototype.set_add_to_cart=function(a,b){b.find(".variation_id").val(a)},viwpvs_get_variations.prototype.check_is_equal=function(e,f){let c=Object.getOwnPropertyNames(e),h=Object.getOwnPropertyNames(f);if(c.length!==h.length)return!1;for(let d=0;d<c.length;d++){let g=c[d],a=e[g],b=f[g];if(void 0!==a&& void 0!==b&&null!==a&&null!==b&&0!==a.length&&0!==b.length&&a!==b)return!1}return!0},viwpvs_get_variations.prototype.get_img_product=function(c,e=!1){let a,b;if((a="uncode"===viwpvs_frontend_loop_product_params.theme?c.closest(".tmb-woocommerce"):c.closest(".product")).length||(a=c.closest(".item-product")),a.length||(a=c.closest(".product-item")),a.length||(a=c.closest(".gdlr-core-item-list")),a.length||(a=c.closest(".product-warp-item")),a.length||(a=c.closest(".jet-woo-products__item")),a.length||(a=c.closest(".product__box")),c.closest(".woo-entry-inner").length&&(a=c.closest(".woo-entry-inner")),e&&window.outerWidth>549&&a.find("img.show-on-hover").length?b=a.find("img.show-on-hover").first():a.find(".slick-current.slick-active").length?b=a.find(".slick-current.slick-active").first():a.find(".attachment-shop_catalog").length?b=a.find(".attachment-shop_catalog").first():a.find(".gdlr-core-product-thumbnail").length?b=a.find(".gdlr-core-product-thumbnail").first():a.find(".woo-entry-image-main.lazyloaded").length?b=a.find(".woo-entry-image-main.lazyloaded").first():a.find(".woo-entry-image-main").length?b=a.find(".woo-entry-image-main").first():a.find(".wp-post-image.vi-load").length?b=a.find(".wp-post-image.vi-load ").first():a.find(".attachment-woocommerce_thumbnail").length?b=a.find(".attachment-woocommerce_thumbnail").first():a.find(".primary-thumb img").length?b=a.find(".primary-thumb img").first():a.find(".wp-post-image").length&&(b=a.find(".wp-post-image").first()),!b){if(a&&a.find("img")){let d=a.find(".preview-thumb img");b=d.length>0?d:a.find("img").first()}else b=!1}return b&&b.find("img").length>0&&(b=b.find("img").first()),b},jQuery.fn.wpvs_get_variation=function(){return new viwpvs_get_variations(this),this}